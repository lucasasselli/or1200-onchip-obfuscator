   __ ___      __  ____  ___  ______  ______________ __________  ___ 
  / // / | /| / / / __ \/ _ )/ __/ / / / __/ ___/ _ /_  __/ __ \/ _ \
 / _  /| |/ |/ / / /_/ / _  / _// /_/ /\ \/ /__/ __ |/ / / /_/ / , _/
/_//_/ |__/|__/  \____/____/_/  \____/___/\___/_/ |_/_/  \____/_/|_| 

Author : Luca Sasselli
Rev    : 2

TODOS:
    - Exception management
    - Implement type S and N 

WHAT IS AN HARDWARE OBFUSCATOR?

    An hardware obfuscator is a software obfuscator implemented directly in a processor pipeline,
    in the attempt to mitigate hardware trojan activation. 

INSTRUCTION TYPES

    000     Type N      xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    001     Type A      OOOOOODDDDDAAAAABBBBB_XXXX__YYYY
    010     Type I      OOOOOODDDDDAAAAAIIIIIIIIIIIIIIII
    011     Type M      OOOOOOIIIIIAAAAABBBBBIIIIIIIIIII
    100     Type F      OOOOOOFFFFFAAAAABBBBB___________
    101     Type FI     OOOOOOFFFFFAAAAAIIIIIIIIIIIIIIII
    110     Type B      OOOOOONNNNNNNNNNNNNNNNNNNNNNNNNN
    111     Type S      Non standanrd op. code

LUT WORD

    +---------+---------+------+
    | 15 - 12 | 11 - 1  | 0    |
    +---------+---------+------+
    | TYPE    | COMMAND | STOP |
    +---------+---------+------+

    Type A command:

    +--------+-------+---+-------+---+
    | 11 - 8 | 7 - 4 | 3 | 2 - 1 | 0 |
    +--------+-------+---+-------+---+
    | AOPC1  | AOPC2 | D | A     | B |
    +--------+-------+---+-------+---+

    - AOPC1:
            Arith. operation 1nd opcode

    - AOPC2:
            Arith. operation 2rd opcode
            
    - D:
            1: r0
            0: rD

    - A:
            00: rA
            01: rB
            10: rD
            11: r0
            
    - B:
            1: r0
            0: rB
            
    Type I command:

    +--------+-------+---+-------+---+
    | 11 - 6 | 5 - 4 | 3 | 2 - 1 | 0 |
    +--------+-------+---+-------+---+
    | OPC    | I     | D | A     | R |
    +--------+-------+---+-------+---+

    - OPC:
            Instruction opcode
            
    - I:
            00: Original immediate
            01: Zero immediate
            10: Custom immediate
            11: Reserved
            
    - D:
            1: r0
            0: rD

    - A:
            00: rA
            01: rB
            10: rD
            11: r0
            
    Type M command:

    +--------+-------+---+-------+---+
    | 11 - 6 | 5 - 4 | 3 | 2 - 1 | 0 |
    +--------+-------+---+-------+---+
    | OPC    | I     | R | A     | B |
    +--------+-------+---+-------+---+

    - OPC:
            Instruction opcode

    - I:
            00: Original immediate
            01: Zero immediate
            10: Custom immediate
            11: Reserved

    - A:
            00: rA
            01: rB
            10: rD
            11: r0

    - B:
            1: r0
            0: rB

    Type F command:

    +--------+-------+-------+-------+---+
    | 11 - 9 | 8 - 5 | 4 - 3 | 2 - 1 | 0 |
    +--------+-------+-------+-------+---+
    | FOPC   | R     | B     | A     | R |
    +--------+-------+-------+-------+---+

    - FOP:
            Flag. operation opcode
            
    - A:
            00: rA
            01: rB
            10: Reserved
            11: r0
            
    - B:
            00: rA
            01: rB
            10: Reserved
            11: r0

    Type FI command:

    +--------+-------+-------+---+-------+---+
    | 11 - 9 | 8 - 6 | 5 - 4 | I | 2 - 1 | 0 |
    +--------+-------+-------+---+-------+---+
    | FOPC   | R     | I     | R | A     | R |
    +--------+-------+-------+---+-------+---+

    - FOP:
            Flag. operation opcode

    - I:
            00: Original immediate
            01: Zero immediate
            10: Custom immediate
            11: Reserved
            
    - A:
            00: rA
            01: rB
            10: Reserved
            11: r0
